datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// User Model: Represents a user of the application
// Phase 1 MVP will not have full user management, but we define the model
// for future phases (Phase 2: Auth).
model User {
  id           String    @id @default(uuid())
  email        String    @unique
  passwordHash String?   // Stored for email/password login, if we implement it
  isPaid       Boolean   @default(false)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  redirects Redirect[] // A user can have multiple redirects

  @@map("users") // Map model name to table name
}

// Redirect Model: Stores dynamic QR code mappings and their stats
// This is the core functionality of Phase 1
model Redirect {
  id         String    @id @default(uuid())
  userId     String?   // Optional: For future phases where QRs are tied to users
  slug       String    @unique @db.VarChar(16) // The short code for the redirect
  targetUrl  String    @db.Text             // The URL to redirect to
  clicks     BigInt    @default(0)          // Counter for analytics
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  user User? @relation(fields: [userId], references: [id]) // Relationship to User model

  @@map("redirects") // Map model name to table name
}
